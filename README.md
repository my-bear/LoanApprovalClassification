# Loan Approval Classification

В данном проекте реализовано предсказание одобрения кредитной заявки на основе характеристик заёмщика.

## Постановка задачи

Необходимо построить модель машинного обучения, которая определяет:

Будет ли кредитная заявка одобрена (1) или отклонена (0).

Данные содержат информацию о доходе клиента, занятости, кредитной истории, сумме кредита и других характеристиках.

Цель — разработать устойчивую модель с хорошей обобщающей способностью и интерпретируемыми результатами.


## Анализ данных (EDA)

**Выполнены следующие шаги:**

- Анализ распределения целевой переменной  

- Проверка пропусков  

- Исследование числовых признаков  

- Анализ категориальных признаков  

- Корреляционный анализ  

**Основные выводы:**

- Кредитная история — наиболее важный фактор одобрения.

- Более высокий доход увеличивает вероятность положительного решения.

- Высокое соотношение "сумма кредита / доход" снижает вероятность одобрения.

- Обнаружен умеренный дисбаланс классов.

## Предобработка данных

Пропуски не обнаружены.

Кодирование категориальных признаков:

- One-Hot Encoding

Масштабирование признаков (для линейных моделей)

Разделение на обучающую, валидационную и тестовую выборки


## Feature Engineering

Были созданы дополнительные признаки:

emp_exp_per_age (отношение опыта работы к возрасту)

cred_hist_per_age (отношение подолжительности кредитной истории в годах к возрасту)


## Обученные модели

**В проекте были протестированы:**

- Logistic Regression

- Random Forest

- Gradient Boosting (CatBoost)

- KNN

- SVM

**Подбор гиперпараметров:**

- RandomizedSearchCV

- Optuna

## Метрики оценки

- ROC-AUC

- Precision

- Recall

- F1-score

ROC-AUC выбрана как ключевая метрика из-за возможного дисбаланса классов и большей бизнес-значимости.

## Результаты

Модель **Logistic Regression** (из коробки) показала высокий результа. Подбор гиперпараметров не дал результата лучше.  
- F1: 0.7413  
- precision: 0.6975  
- recall: 0.791  
- ROC AUC: 0.9499  

При обучении **CatBoost** модель смогла превзойти результат логистической регрессии.  
- F1: 0.7795 
- precision: 0.6801  
- recall: 0.913
- ROC AUC: 0.9734 

Основной выбор был модели по ROC AUC и F1 метрикам, т.к. учитывалась важность обоих классов.  
Модель с высоким precision может одобрить мало клиентов, но почти все они будут «правильными».
Низкий recall означает, что модель пропускает много клиентов, которым можно было одобрить кредит.

## Бизнес-выводы

Анализ распределений и важности признаков показал, что наличие положительной кредитной истории резко увеличивает вероятность одобрения.

Это также означает потенциальную проблему:
- модель сильно зависит от одного признака, что может снижать устойчивость к изменению политики кредитования.

Абсолютный доход сам по себе менее информативен, чем нормированные показатели (Loan-to-Income).

Это говорит о том, что:

- платёжеспособность важнее уровня дохода,

- риск формируется через нагрузку, а не через величину займа.

## Важность признаков

**Наиболее значимые признаки:**

- Показатель предыдущих неплатежей по кредитам

- Статус владения жильем

- Цель кредита


В ноутбуке приведен график важности признаков.

##  Установка зависимостей:

    poetry install

